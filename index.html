<!doctype html>
<meta charset=utf-8>
<title>Visual: Demo</title>
<link rel=stylesheet href=visual.css>

<body>
<script src=visual.js></script>
<script>

var categories = [
 // id   category name  color
  [0,  "undefined",   '#d42828'],
  [1,  "Motion",      '#4a6cd4'],
  [2,  "Looks",       '#8a55d7'],
  [3,  "Sound",       '#bb42c3'],
  [4,  "Pen",         '#0e9a6c'], // Scratch 1.4: #009870
  [5,  "Events",      '#c88330'],
  [6,  "Control",     '#e1a91a'],
  [7,  "Sensing",     '#2ca5e2'],
  [8,  "Operators",   '#5cb712'],
  [9,  "Data",        '#ee7d16'], // Scratch 1.4: #f3761d
  [10, "More Blocks", '#632d99'], // #531e99
  [11, "Parameter",   '#5947b1'],
  [12, "List",        '#cc5b22'], // Scratch 1.4: #d94d11
  [20, "Exension",    '#4b4a60'], // #72228c / #672d79
];

var vis = Visual({
  categories: {
    undefined: ["undefined", '#d42828'],
    motion: ["Motion", '#4a6cd4'],
    looks: ["Looks", '#8a55d7'],
    sound: ["Sound", '#bb42c3'],
    pen: ["Pen", '#0e9a6c'], // Scratch 1.4: #009870
    events: ["Events", '#c88330'],
    control: ["Control", '#e1a91a'],
    sensing: ["Sensing", '#2ca5e2'],
    operators: ["Operators", '#5cb712'],
    data: ["Data", '#ee7d16'], // Scratch 1.4: #f3761d
    moreBlocks: ["More Blocks", '#632d99'], // #531e99
    parameter: ["Parameter", '#5947b1'],
    list: ["List", '#cc5b22'], // Scratch 1.4: #d94d11
    exension: ["Exension", '#4b4a60'] // #72228c / #672d79
  },
  blocks: {
    if: ['c', 'if %b then %t', 'control'],
    repeat: ['c', '@loop repeat %n %t', 'control', 10],
    say: ['c', 'say %s', 'looks', 'Hello!'],
    set: ['c', 'set %m.var to %s', 'data', 'variable', 0],
    move: ['c', 'move %n steps', 'motion', 10],
    wait: ['c', 'wait %n secs', 'control', 1],
    deleteClone: ['f', 'delete this clone', 'control'],
    touchingColor: ['b', 'touching color %c?', 'sensing'],
    answer: ['r', 'answer', 'sensing'],
    add: ['r', '%n + %n', 'operators', ' ', ' '],
    and: ['b', '%b and %b', 'operators'],
    lambda: ['r', 'lambda %t', 'operators'],
    join: ['r', 'join %s %s', 'operators'],
    equal: ['b', '%s = %s', 'operators'],
    play: ['c', 'play drum %d.drum for %n beats', 'sound', 1, 10],
  }
});

var w = new vis.Workspace(document.body);

w.add(20, 20, new vis.Script()
  .add(new vis.Block('repeat', [10]))
  .add(new vis.Block('say'))
  .add(new vis.Block('if'))
  .add(new vis.Block('if', [new vis.Block('and', [new vis.Block('touchingColor'), new vis.Block('equal')])]))
  .add(new vis.Block('move', [new vis.Block('add', [new vis.Block('join', [new vis.Block('answer')]), 1])]))
  .add(new vis.Block('wait'))
  .add(new vis.Block('deleteClone')));

w.scripts[0].blocks[0].args[1].script
  .add(new vis.Block('repeat'))
  .add(new vis.Block('wait'))
  .add(new vis.Block('set'))
  .add(new vis.Block('play'));

// var script = new vis.Script();

// for (var i = 128; i--;) {
//   script.add(new vis.Block('set'));
// }

// w.add(200, 20, script);

</script>
