<!doctype html>
<meta charset=utf-8>
<title>Visual: Demo</title>
<link rel=stylesheet href=visual.css>

<style>
html, body {
  height: 100%;
  margin: 0;
  overflow: hidden;
}
.palette {
  position: absolute;
  top: 0;
  left: 0;
  width: 200px;
  bottom: 0;
  background: #eee;
  border-right: 1px solid #aaa;
}
.workspace {
  position: absolute;
  top: 0;
  left: 201px;
  right: 0;
  bottom: 0;
}
</style>

<body>
<div class=palette></div>
<div class=workspace></div>
<script src=visual.js></script>
<script>

var categories = [
 // id   category name  color
  [0,  "undefined",   '#d42828'],
  [1,  "Motion",      '#4a6cd4'],
  [2,  "Looks",       '#8a55d7'],
  [3,  "Sound",       '#bb42c3'],
  [4,  "Pen",         '#0e9a6c'], // Scratch 1.4: #009870
  [5,  "Events",      '#c88330'],
  [6,  "Control",     '#e1a91a'],
  [7,  "Sensing",     '#2ca5e2'],
  [8,  "Operators",   '#5cb712'],
  [9,  "Data",        '#ee7d16'], // Scratch 1.4: #f3761d
  [10, "More Blocks", '#632d99'], // #531e99
  [11, "Parameter",   '#5947b1'],
  [12, "List",        '#cc5b22'], // Scratch 1.4: #d94d11
  [20, "Exension",    '#4b4a60'], // #72228c / #672d79
];

var vis = Visual({
  categories: {
    undefined: ["undefined", '#d42828'],
    motion: ["Motion", '#4a6cd4'],
    looks: ["Looks", '#8a55d7'],
    sound: ["Sound", '#bb42c3'],
    pen: ["Pen", '#0e9a6c'], // Scratch 1.4: #009870
    events: ["Events", '#c88330'],
    control: ["Control", '#e1a91a'],
    sensing: ["Sensing", '#2ca5e2'],
    operators: ["Operators", '#5cb712'],
    data: ["Data", '#ee7d16'], // Scratch 1.4: #f3761d
    moreBlocks: ["More Blocks", '#632d99'], // #531e99
    parameter: ["Parameter", '#5947b1'],
    list: ["List", '#cc5b22'], // Scratch 1.4: #d94d11
    exension: ["Exension", '#4b4a60'] // #72228c / #672d79
  },
  blocks: {
    if: ['c', 'if %b then %t', 'control'],
    ifElse: ['c', 'if %b then %t else %t', 'control'],
    repeat: ['c', '@loop repeat %n %t', 'control', 10],
    say: ['c', 'say %s', 'looks', 'Hello!'],
    set: ['c', 'set %m.var to %s', 'data', 'variable', 0],
    move: ['c', 'move %n steps', 'motion', 10],
    wait: ['c', 'wait %n secs', 'control', 1],
    deleteClone: ['f', 'delete this clone', 'control'],
    touchingColor: ['b', 'touching color %c?', 'sensing'],
    answer: ['r', 'answer', 'sensing'],
    add: ['r', '%n + %n', 'operators', ' ', ' '],
    and: ['b', '%b and %b', 'operators'],
    lambda: ['r', 'the script %t', 'operators'],
    join: ['r', 'join %s %s', 'operators'],
    equal: ['b', '%s = %s', 'operators'],
    play: ['c', 'play drum %d.drum for %n beats', 'sound', 1, 10],
  }
});

var app = new vis.App();

var p = new vis.Workspace(document.querySelector('.palette'));
p.isPalette = true;
app.add(p);

var w = new vis.Workspace(document.querySelector('.workspace'));
app.add(w);

w.add(20, 20, new vis.Script()
  .add(new vis.Block('repeat', [10, new vis.Script()
    .add(new vis.Block('repeat'))
    .add(new vis.Block('wait'))
    .add(new vis.Block('set', ['variable', new vis.Block('lambda')]))
    .add(new vis.Block('play'))]))
  .add(new vis.Block('say'))
  .add(new vis.Block('ifElse'))
  .add(new vis.Block('if', [new vis.Block('and', [new vis.Block('touchingColor'), new vis.Block('equal')])]))
  .add(new vis.Block('move', [new vis.Block('add', [new vis.Block('join', [new vis.Block('answer')]), 1])]))
  .add(new vis.Block('wait'))
  .add(new vis.Block('deleteClone')));

// var script = new vis.Script();

// for (var i = 512; i--;) {
//   script.add(new vis.Block('set'));
// }

// w.add(400, 20, script);

</script>
